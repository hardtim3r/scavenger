<!DOCTYPE html>
<html lang="nl">
<head>
  <meta charset="UTF-8" />
  <title>Scavenger Hunt – Locatie-opdracht</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <style>
    body {
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      background: #050814;
      color: #f7f7ff;
      margin: 0;
      padding: 16px;
      display: flex;
      min-height: 100vh;
      box-sizing: border-box;
    }

    .wrapper {
      margin: auto;
      max-width: 480px;
      text-align: center;
      opacity: 0;
      transform: translateY(8px);
      transition: opacity 0.4s ease, transform 0.4s ease;
    }

    .card {
      background: rgba(15, 18, 40, 0.92);
      border-radius: 24px;
      padding: 24px 22px 20px;
      box-shadow: 0 18px 60px rgba(0,0,0,0.6);
      backdrop-filter: blur(12px);
    }

    .riddle {
      font-size: 1.1rem;
      line-height: 1.6;
      margin-bottom: 14px;
      opacity: 0.96;
      cursor: pointer;
      font-weight: 600;
    }

    .photo {
      margin-bottom: 10px;
      position: relative;
    }

    .photo img {
      max-width: 100%;
      height: auto;
      border-radius: 16px;
      display: block;
      margin: 0 auto;
      cursor: zoom-in;
      transition: opacity 0.3s ease;
    }

    .photo-tip {
      font-size: 0.75rem;
      opacity: 0.5;
      margin-top: 4px;
    }

    .hint {
      font-size: 0.85rem;
      opacity: 0.85;
      margin-top: 8px;
      line-height: 1.4;
    }

    .status {
      font-size: 0.9rem;
      margin-top: 13px;
      min-height: 1.4em;
    }

    button {
      border: none;
      border-radius: 999px;
      padding: 12px 24px;
      font-size: 15px;
      cursor: pointer;
      margin-top: 16px;
      background: linear-gradient(135deg, #ffb3ff, #9f9cff);
      color: #141414;
      font-weight: 600;
    }

    #dev-skip {
      display: none;
      margin-top: 10px;
      background: rgba(255,255,255,0.15);
      color: #fff;
      font-size: 14px;
    }

    /* INTRO OVERLAY */
    .intro-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255,255,255,0.06), transparent 55%), #050814;
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 10;
    }

    .intro-box {
      max-width: 420px;
      padding: 28px 24px 24px;
      border-radius: 24px;
      background: rgba(5, 7, 18, 0.96);
      box-shadow: 0 20px 60px rgba(0,0,0,0.8);
      text-align: center;
      backdrop-filter: blur(14px);
    }

    .intro-text {
      font-size: 1.9rem; /* GROTER */
      line-height: 1.45;
      font-weight: 500;
      margin: 0;
      opacity: 0;
    }

    .intro-text.fade-in {
      animation: introFade 0.8s ease forwards;
    }

    @keyframes introFade {
      from {
        opacity: 0;
        transform: translateY(6px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }
  </style>
</head>
<body>

  <!-- INTRO OVERLAY -->
  <div class="intro-overlay" id="intro-overlay">
    <div class="intro-box">
      <p id="intro-text" class="intro-text"></p>
    </div>
  </div>

  <!-- HOOFDINHOUD -->
  <div class="wrapper" id="main-wrapper">
    <div class="card">

      <p id="riddle" class="riddle">
        Waar is dit?
      </p>

      <div class="photo">
        <img id="photo-img" src="foto1.png" alt="Plek 1" />
        <p class="photo-tip">(Tip: dubbelklik als je ’m beter wil zien)</p>
      </div>

      <p class="hint">
        Sta op de plek waar jij denkt te moeten zijn<br/>
        en bevestig je locatie.
      </p>

      <button id="submit-btn">Bevestig locatie</button>

      <p id="status" class="status"></p>

      <button id="dev-skip">DEV: Skip naar volgende</button>
    </div>
  </div>

<script>
  // ====== COÖRDINATEN ======
  const TARGET_LAT = 51.4528889;
  const TARGET_LON = 5.44425;
  const RADIUS_METERS = 100;

  const NEXT_URL = "vraag.html";

  const submitBtn  = document.getElementById("submit-btn");
  const statusEl   = document.getElementById("status");
  const devSkipBtn = document.getElementById("dev-skip");
  const riddleEl   = document.getElementById("riddle");
  const photoImg   = document.getElementById("photo-img");
  const introOverlay = document.getElementById("intro-overlay");
  const introTextEl  = document.getElementById("intro-text");
  const mainWrapper  = document.getElementById("main-wrapper");

  /* ===== INTRO SEQUENCE ===== */

  const introMessages = [
    "Hoi Hiep",
    "Daar zijn we dan, 100 dagen later.",
    "Ik stuur je op pad.",
    "Ik ga wel mee hoor, is net zo gezellig.",
    "Hopelijk moet je nog wat stappen zetten vandaag.",
    "No worries tho, zó lang is het ook weer niet.",
    "Bedankt dat je bestaat :)."
  ];

  function runIntro() {
    let idx = 0;
    const DISPLAY_TIME = 3400; // LANGZAMER (2× zo langzaam)

    function nextMessage() {
      if (idx >= introMessages.length) {
        introOverlay.style.transition = "opacity 0.45s ease";
        introOverlay.style.opacity = "0";
        setTimeout(() => {
          introOverlay.style.display = "none";
          mainWrapper.style.opacity = "1";
          mainWrapper.style.transform = "translateY(0)";
        }, 450);
        return;
      }

      introTextEl.classList.remove("fade-in");
      void introTextEl.offsetWidth; // reflow
      introTextEl.textContent = introMessages[idx];
      introTextEl.classList.add("fade-in");

      idx++;
      setTimeout(nextMessage, DISPLAY_TIME);
    }

    nextMessage();
  }

  window.addEventListener("load", runIntro);

  /* FOTO SWITCH */
  let photoIndex = 1;
  const photos = { 1:"foto1.png", 2:"foto2.png", 3:"foto3.png" };

  photoImg.addEventListener("dblclick", () => {
    if (photoIndex < 3) {
      photoIndex++;
      photoImg.style.opacity = 0;
      setTimeout(() => {
        photoImg.src = photos[photoIndex];
        photoImg.style.opacity = 1;
      }, 180);
    }
  });

  /* LOCATIE */
  function toRad(x){ return x * Math.PI / 180; }

  function distanceInMeters(lat1, lon1, lat2, lon2) {
    const R = 6371000;
    const dLat = toRad(lat2 - lat1);
    const dLon = toRad(lon2 - lon1);
    const a =
      Math.sin(dLat/2)**2 +
      Math.cos(toRad(lat1))*Math.cos(toRad(lat2))*
      Math.sin(dLon/2)**2;
    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));
    return R*c;
  }

  submitBtn.addEventListener("click", () => {
    if (!navigator.geolocation) {
      statusEl.textContent = "Locatie niet beschikbaar.";
      return;
    }

    statusEl.textContent = "Locatie wordt gecontroleerd…";

    navigator.geolocation.getCurrentPosition(
      pos => {
        const dist = distanceInMeters(pos.coords.latitude, pos.coords.longitude, TARGET_LAT, TARGET_LON);
        if (dist <= RADIUS_METERS) {
          window.location.href = NEXT_URL;
        } else {
          statusEl.textContent = `Fout, je zit er ${Math.round(dist)} meter vandaan.`;
        }
      },
      () => statusEl.textContent = "Locatie ophalen mislukt.",
      { enableHighAccuracy:true, timeout:10000, maximumAge:0 }
    );
  });

  /* DEV MODE */
  let taps = [];
  riddleEl.addEventListener("click", () => {
    const now = Date.now();
    taps.push(now);
    if (taps.length > 3) taps.shift();
    if (taps.length === 3 && taps[2]-taps[0] < 900)
      devSkipBtn.style.display = "inline-block";
  });

  devSkipBtn.addEventListener("click", () => window.location.href = NEXT_URL);
</script>

</body>
</html>
